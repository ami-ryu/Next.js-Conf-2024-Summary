## 뉴욕 공립 도서관 디지털 컬렉션을 Next.js로 마이그레이션하기

뉴욕 공립 도서관에서 일하는 Emma Mansell이 접근성과 성능, 그리고 향후 피쳐 통합을 고려하여 디지털 컬렉션 웹사이트를 Ruby on Rails에서 Next.js로 마이그레이션한 과정을 설명합니다.

### 1. 뉴욕 공립 도서관과 디지털 컬렉션 소개 (0:00 - 6:00)
- 뉴욕 공립 도서관 디지털 컬렉션은 100만개가 넘는 모든 디지털 자료 (인쇄물, 사진, 비디오, 오디오 등) 를 검색하고 열람하는 웹 사이트이다.
- Next.js 를 사용하며 가장 크게 고려한 점: 접근성, SEO
- 대규모 조직이 아닌 저희처럼 소규모 팀, 제한된 리소스, 그리고 접근성을 가장 우선시하는 경우에 Next.js가 어떻게 작동하는지를 보여주려 합니다.

### 2. 기존 Ruby on Rails 웹사이트의 한계 (6:00 - 7:00)
- 성능은 좋지만 2013년에 구축된 옛날 코드이다.
- 접근성 표준을 충족하지 못했다.
- 글꼴 크기, 색상 대비 등을 더 현대적이고 접근성이 뛰어나도록 개선이 필요했다.

### 3. Next.js 를 선택한 이유 (7:00 - 10:10)
- 가볍고, 쉽게 바로 사용 가능
- 하이브리드 렌더링 지원
- Next.js 9~11 버전 개발 경험이 있는 개발자가 있었다.

### 4. Next.js 마이그레이션 단계 (8:50 - 12:19)
- URL 기반으로 마이그레이션을 단계적으로 진행하는 전략을 사용했다.
- 초기에는 Ruby 의 컨트롤러 함수를 1:1로 Next.js API 경로와 매핑하려 했으나 이 방법대신, 파일 기반 라우팅을 사용하는 방법으로 변경했다.
<img width="2102" alt="스크린샷 2024-11-18 오후 8 24 35" src="https://github.com/user-attachments/assets/949481ee-9885-4e12-b467-218494a1c92c">

### 5. 서버 컴포넌트 활용의 어려움
- 자체 디자인 시스템이 Chakra UI 기반으로 제작되어 서버 측 렌더링과 호환되지 않는 문제점이 있었다.
- 이와 같은 문제를 최대한 극복하기 위해 `'use client'` 지시문을 최대한 아래로 이동시키는 것을 목표로 했다.
- 아래 핑크색 원이 자체 디자인 시스템의 provider 이다.
<img width="2093" alt="스크린샷 2024-11-18 오후 8 27 32" src="https://github.com/user-attachments/assets/c611a13f-1412-4777-bc92-d44ad2502ee4">

### 6. Next.js 에서 얻은 다른 이점들
- 서버 컴포넌트 활용의 어려움에도 불구하고 앱 라우터를 도입한 이유를 설명합니다.
- 라우터 캐싱: 범용 header/footer 를 가지고 있어서, 페이지 로드 시간을 단축하는데 큰 도움이 되었다.
- Error Boundary: 모든 오류를 한곳에서 처리하여 편리하게 사용했다.
- Loading, Suspense: Next.js 14 버전에서 훨씬 명확해져서 쉽게 사용했다.

### 7. Vercel Preview를 통한 협업 및 접근성 향상
- Vercel Preview를 통해 반복적인 개발 속도를 높이고 의사 결정 과정을 10배 단축하여 효율성을 극대화했다.
- Vercel Preview를 활용하여 개발 담당자들과 접근성 컨설턴트 간의 협업을 강화하고 빠른 피드백을 통해 접근성을 크게 개선했다.

### 8. 향후 계획, Q&A
- 향후 Next Image를 활용한 이미지 최적화를 할 계획.
- 접근성 평가는 전문 접근성 컨설턴트를 통해 이루어진다. 개발 단계에서는 light house 를 이용한다.
- 영국 도서관 해킹 사건으로 인해, 현재 보안 구성이 되어있는 AWS 에 배포 중인데 Vercel 에서도 가능하다면 하고 싶다.
